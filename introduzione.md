Introduzione

Il settore energetico sta attraversando una fase di profonda trasformazione, guidata da cambiamenti normativi, crescita del business e una crescente necessità di competitività. In questo contesto, la gestione efficace dei dati e la capacità di prevedere accuratamente i consumi energetici diventano fattori critici per il successo aziendale. Questo progetto nasce dall'esperienza diretta nel ruolo di Supply & Portfolio Manager, dove le sfide quotidiane hanno evidenziato i limiti delle architetture tradizionali e la necessità di una trasformazione digitale strutturata.

1.1. Contesto: Le Sfide del Mercato Energetico Moderno

Il mercato energetico italiano è caratterizzato da una complessità crescente che richiede strumenti sempre più sofisticati per la gestione operativa. I fattori principali che guidano questa trasformazione sono tre.
Il primo fattore è l'evoluzione normativa del mercato. Il passaggio del Mercato del Giorno Prima da una risoluzione oraria a una quart'oraria rappresenta un cambiamento epocale. Per comprendere la portata di questa trasformazione, basta considerare che per una singola utenza si passa da 8.760 misure di consumi annuali a 35.040 misure. Questo significa che ogni sistema di gestione dati, ogni processo di elaborazione e ogni modello di previsione deve essere ripensato per gestire un volume di informazioni quattro volte superiore. Non si tratta solo di una questione quantitativa: la granularità quart'oraria permette di cogliere dinamiche di consumo molto più dettagliate, ma richiede anche capacità computazionali e infrastrutture dati che i sistemi tradizionali non possono fornire.
Il secondo fattore è la crescita costante del business. Il portafoglio clienti gestito conta circa 60.000 punti di prelievo, un numero destinato a crescere nel tempo. Ogni nuovo cliente aggiunge complessità al sistema: nuovi dati da acquisire, nuove variabili da considerare nelle previsioni, nuove relazioni da gestire. I sistemi basati su fogli Excel o database Access, per quanto funzionali in contesti più limitati, mostrano tutti i loro limiti quando devono scalare a queste dimensioni. Le operazioni diventano lente, i file si corrompono, i rischi di errore aumentano esponenzialmente.
Il terzo fattore è la necessità di competitività. Nel mercato energetico, la precisione delle previsioni di consumo ha un impatto economico diretto. Ogni errore di previsione si traduce in costi di sbilanciamento che erodono i margini. In un mercato sempre più competitivo, dove i margini operativi si assottigliano, la capacità di prevedere con accuratezza i consumi e di ottimizzare le strategie di acquisto diventa un vantaggio competitivo fondamentale. Questo richiede non solo modelli di previsione avanzati, ma anche la capacità di automatizzare le attività ripetitive per liberare risorse umane che possono essere dedicate ad attività strategiche e a maggior valore aggiunto.

1.2. Il Problema: Limiti delle Architetture Tradizionali

Molte realtà aziendali, soprattutto nelle piccole e medie imprese del settore energetico, si affidano ancora a un'architettura dati tradizionale basata su strumenti di office automation. Questi sistemi, costruiti negli anni utilizzando Microsoft Excel, Access e macro in Visual Basic for Applications, hanno rappresentato per lungo tempo una soluzione funzionale ed economica. Tuttavia, di fronte alle sfide del mercato moderno, mostrano oggi tutti i loro limiti strutturali.
Il primo limite è la scarsa scalabilità. I database Access hanno dimensioni massime predefinite e le performance degradano rapidamente quando i dati superano una certa soglia. I fogli Excel, per quanto versatili, non sono progettati per gestire milioni di righe di dati. Le operazioni che prima richiedevano pochi secondi iniziano a impiegare minuti o addirittura ore. Le macro VBA, scritte per gestire volumi di dati limitati, diventano lente e instabili. Ogni aggiunta di nuovi clienti o ogni incremento della granularità dei dati rende i processi sempre più macchinosi, fino al punto in cui diventano quasi inutilizzabili.
Il secondo limite è la bassa accuratezza dei modelli di previsione. I metodi tradizionali di forecasting utilizzati in questi sistemi si basano tipicamente sulla ricalendarizzazione dei consumi storici. In pratica, si prende il consumo registrato in un giorno dello scorso anno con caratteristiche simili e lo si utilizza come previsione per il giorno futuro. Questo approccio, per quanto semplice e immediato, non riesce a cogliere le complesse dinamiche che influenzano i consumi energetici. Non considera adeguatamente l'impatto delle variazioni meteorologiche, l'evoluzione dei pattern di consumo nel tempo, le correlazioni non lineari tra diverse variabili. Il risultato sono previsioni imprecise che generano costi di sbilanciamento evitabili.
Il terzo limite è la frammentazione dei dati. In un'architettura tradizionale, i dati sono tipicamente dispersi in decine o centinaia di file diversi. Ogni procedura operativa ha i suoi file Excel, ogni analisi crea nuove copie dei dati, ogni operatore mantiene le proprie versioni locali. Questa frammentazione crea problemi di consistenza: è difficile sapere quale sia la versione più aggiornata di un dato, è facile lavorare su informazioni obsolete, è complesso garantire che tutti gli operatori vedano la stessa situazione. Inoltre, non esiste una vera tracciabilità: è difficile ricostruire come un dato è stato calcolato, chi lo ha modificato, quando è stato aggiornato l'ultima volta.
Il quarto limite è l'alto rischio di errore umano. I processi manuali sono per loro natura soggetti a errori. Copiare dati da un file all'altro, eseguire sequenze complesse di operazioni, ricordarsi di aggiornare tutti i file necessari: ogni passaggio manuale è un potenziale punto di fallimento. In un'operatività quotidiana frenetica, con scadenze stringenti e procedure complesse da seguire, il rischio che qualcosa vada storto è sempre presente. E quando un errore si verifica, spesso viene scoperto troppo tardi, quando ha già causato problemi operativi o economici.

1.3. La Soluzione: Un Ecosistema Integrato

Questo progetto nasce dalla necessità di superare i limiti appena descritti, emersa direttamente dalle sfide quotidiane affrontate nel ruolo di Supply & Portfolio Manager. Non si tratta di un esercizio teorico o di un esperimento tecnologico fine a se stesso, ma di una risposta concreta a problemi operativi reali. Il progetto si allinea perfettamente con le responsabilità della mansione, che includono non solo il forecasting e il portfolio management, ma anche esplicitamente lo sviluppo di database per accelerare la gestione dei processi.
La soluzione proposta è un ecosistema software integrato, moderno e intelligente, che poggia su tre pilastri fondamentali.
Il primo pilastro è la centralizzazione dei dati. Al cuore del sistema c'è un database SQL Server che funge da unica fonte di verità per tutti i dati relativi al portafoglio energetico. Tutti i dati di consumo, le anagrafiche dei clienti, i dati di mercato, le previsioni, i dati meteorologici confluiscono in questo database centralizzato. Questo elimina la frammentazione, garantisce la consistenza delle informazioni e crea una base solida su cui costruire tutti gli altri componenti del sistema. La migrazione verso questa architettura centralizzata è stata progettata in modo graduale per garantire la continuità operativa, spostando un pezzo alla volta e verificando che tutto funzionasse correttamente prima di passare al successivo.
Il secondo pilastro è l'automazione dei processi. Sono stati sviluppati numerosi script e applicazioni in Python per automatizzare tutte le attività ripetitive e soggette a errore. Questi strumenti si occupano di acquisire automaticamente i dati da fonti eterogenee, elaborarli secondo le logiche di business necessarie, caricarli nel database centralizzato e generare gli output richiesti. L'automazione non si limita all'elaborazione dei dati, ma include anche la gestione delle procedure operative attraverso ChecklistApp, un'applicazione che guida gli operatori passo-passo nell'esecuzione di attività complesse, riducendo drasticamente il rischio di errore umano.
Il terzo pilastro è il modello di machine learning applicato al forecasting. Il sistema implementa modelli di Machine Learning per la previsione dei consumi che superano i limiti dei metodi tradizionali. Questi modelli sono in grado di apprendere dai dati storici, cogliere pattern complessi e non lineari, adattarsi dinamicamente ai cambiamenti. Il forecasting è strutturato su due livelli: un primo modello che corregge gli errori sistematici delle previsioni tradizionali e un secondo modello che affina ulteriormente le previsioni utilizzando dati meteorologici avanzati. A supporto di questi modelli, è stata sviluppata una dashboard analitica interattiva che permette di visualizzare i dati in tempo reale, confrontare diverse previsioni e validare le decisioni operative.
Questi tre pilastri non sono componenti isolate, ma elementi di un ecosistema integrato dove ogni parte comunica con le altre. I dati fluiscono automaticamente dal database ai modelli di previsione, le previsioni vengono visualizzate nella dashboard, le decisioni prese sulla base della dashboard vengono registrate nel database creando uno storico tracciabile. Questa integrazione crea un sistema coerente, efficiente e scalabile.

1.4. Obiettivi del Progetto

Il progetto descritto in questa tesi si pone obiettivi ambiziosi ma concreti, tutti orientati a creare valore operativo misurabile.
Il primo obiettivo è modernizzare l'infrastruttura dati, migrando da un'architettura basata su Access e macro VBA a un'architettura SQL-centrica. Questo significa non solo spostare i dati da un sistema all'altro, ma ripensare completamente come i dati vengono strutturati, relazionati e utilizzati. L'obiettivo è creare un'infrastruttura che sia scalabile, robusta e preparata per gestire i volumi di dati futuri.
Il secondo obiettivo è automatizzare i processi di acquisizione, trasformazione e caricamento dei dati. Ogni file che arriva dall'esterno, che sia un file Excel con i consumi, un CSV con i dati di mercato o un archivio ZIP con le anagrafiche, deve essere processato automaticamente senza intervento manuale. Questo non solo riduce il tempo necessario per queste operazioni, ma elimina anche il rischio di errori umani e garantisce che i dati siano sempre aggiornati e disponibili per le analisi.
Il terzo obiettivo è innovare il processo di forecasting introducendo tecniche di Machine Learning. L'obiettivo non è sostituire completamente il sistema esistente, che ha dimostrato nel tempo di essere efficace per certi aspetti, ma potenziarlo e affinarlo. I modelli di Machine Learning devono essere in grado di correggere gli errori sistematici delle previsioni tradizionali e di catturare le relazioni complesse tra consumi e variabili esterne come la meteorologia.
Il quarto obiettivo è migliorare le capacità di analisi attraverso strumenti di visualizzazione avanzati. Le decisioni operative devono essere supportate da analisi approfondite e intuitive. La dashboard deve permettere di esplorare i dati in tempo reale, confrontare scenari diversi, validare le previsioni e tracciare le decisioni prese. Deve essere uno strumento di lavoro quotidiano, non un report statico che viene consultato occasionalmente.
Un obiettivo trasversale, che permea tutti gli altri, è quello di creare strumenti che siano non solo tecnicamente avanzati, ma anche facilmente utilizzabili da operatori non tecnici. Ogni componente sviluppato è stato progettato con attenzione all'esperienza utente e accompagnato da documentazione dettagliata pensata per chi non ha competenze di programmazione. Questo garantisce che gli strumenti possano essere effettivamente adottati dall'organizzazione e che le conoscenze non restino concentrate in una sola persona.
Questi obiettivi non sono teorici, ma nascono da esigenze operative concrete e sono tutti misurabili in termini di efficienza guadagnata, errori evitati, tempo risparmiato e qualità delle previsioni migliorata. Nei capitoli successivi verrà descritto in dettaglio come ogni obiettivo è stato perseguito e quali risultati sono stati ottenuti.
